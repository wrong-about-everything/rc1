<?php

declare(strict_types=1);

namespace RC\Tests\Unit\Domain\Matches;

use PHPUnit\Framework\TestCase;
use RC\Domain\Matches\ReadModel\Pure\GeneratedMatchesForSegment;

class GeneratedMatchesForSegmentTest extends TestCase
{
    /**
     * @dataProvider participantInterestsAndPairs
     */
    public function testDifferentCombinations(array $participants2Interests, array $participants2Pairs, array $pairsAndDropouts)
    {
        $this->assertEquals(
            $pairsAndDropouts,
            (new GeneratedMatchesForSegment($participants2Interests, $participants2Pairs))->value()
        );
    }

    public function participantInterestsAndPairs()
    {
        return [
            [
                [
                    11 => ['a'],
                ],
                [],
                [
                    'dropouts' => [11],
                    'matches' => [],
                ]
            ],
            [
                [
                    11 => ['a'],
                    22 => ['a'],
                ],
                [],
                [
                    'dropouts' => [],
                    'matches' => [[11, 22]],
                ]
            ],
            [
                [
                    11 => ['a'],
                    22 => ['a'],
                ],
                [
                    11 => [22],
                    22 => [11],
                ],
                [
                    'dropouts' => [11, 22],
                    'matches' => [],
                ]
            ],
            [
                [
                    11 => ['a', 'c'],
                    22 => ['a', 'c'],
                ],
                [],
                [
                    'dropouts' => [],
                    'matches' => [[11, 22]],
                ]
            ],
            [
                [
                    11 => ['a', 'c'],
                    22 => ['a', 'c'],
                ],
                [
                    11 => [22],
                    22 => [11],
                ],
                [
                    'dropouts' => [11, 22],
                    'matches' => [],
                ]
            ],
            [
                [
                    11 => ['a', 'c', 'b'],
                    22 => ['a', 'c'],
                ],
                [],
                [
                    'dropouts' => [],
                    'matches' => [[22, 11]],
                ]
            ],
            [
                [
                    11 => ['a', 'c', 'b', 'd'],
                    22 => ['a', 'c'],
                ],
                [],
                [
                    'dropouts' => [],
                    'matches' => [[22, 11]],
                ]
            ],
            [
                [
                    11 => ['d'],
                    22 => ['d', 'c', 'b'],
                    33 => ['d', 'c'],
                ],
                [],
                [
                    'dropouts' => [22],
                    'matches' => [[11, 33]],
                ]
            ],
            [
                [
                    11 => ['d'],
                    22 => ['d', 'c', 'b'],
                    33 => ['d', 'c'],
                ],
                [
                    11 => [33],
                    33 => [11],
                ],
                [
                    'dropouts' => [33],
                    'matches' => [[11, 22]],
                ]
            ],
            [
                [
                    11 => ['d'],
                    22 => ['d', 'c', 'b'],
                    33 => ['d', 'c'],
                ],
                [
                    11 => [22],
                    22 => [11],
                    33 => []
                ],
                [
                    'dropouts' => [22],
                    'matches' => [[11, 33]],
                ]
            ],
            [
                [
                    11 => ['d'],
                    22 => ['d', 'c', 'b'],
                    33 => ['d', 'c'],
                ],
                [
                    11 => [22, 33],
                    22 => [11, 33],
                    33 => [11, 22]
                ],
                [
                    'dropouts' => [11, 33, 22],
                    'matches' => [],
                ]
            ],
            [
                [
                    44 => ['a'],
                    22 => ['d', 'c', 'b'],
                    33 => ['d', 'c'],
                ],
                [],
                [
                    'dropouts' => [44],
                    'matches' => [[33, 22]],
                ]
            ],
            [
                [
                    44 => ['a'],
                    22 => ['d', 'c', 'b'],
                    33 => ['d', 'c'],
                ],
                [
                    22 => [33],
                    33 => [22]
                ],
                [
                    'dropouts' => [44, 33, 22],
                    'matches' => [],
                ]
            ],
            [
                [
                    44 => ['a'],
                    22 => ['d', 'c', 'b'],
                    33 => ['d', 'c'],
                ],
                [
                    44 => [33],
                    33 => [44]
                ],
                [
                    'dropouts' => [44],
                    'matches' => [[33, 22]],
                ]
            ],
            [
                [
                    11 => ['d'],
                    44 => ['a'],
                    22 => ['d', 'c', 'b'],
                    33 => ['d', 'c'],
                ],
                [],
                [
                    'dropouts' => [44, 22],
                    'matches' => [[11, 33]],
                ]
            ],
            [
                [
                    11 => ['d'],
                    44 => ['a'],
                    22 => ['d', 'c', 'b'],
                    33 => ['d', 'c'],
                ],
                [
                    11 => [33],
                    33 => [11],
                ],
                [
                    'dropouts' => [44, 33],
                    'matches' => [[11, 22]],
                ]
            ],
            [
                [
                    11 => ['d'],
                    44 => ['a'],
                    22 => ['d', 'c', 'b'],
                    33 => ['d', 'c'],
                ],
                [
                    11 => [22, 33],
                    33 => [11],
                ],
                [
                    'dropouts' => [11, 44],
                    'matches' => [[33, 22]],
                ]
            ],
            [
                [
                    11 => ['d'],
                    44 => ['a'],
                    22 => ['d', 'c', 'b'],
                    33 => ['d', 'c'],
                ],
                [
                    11 => [22, 33],
                    33 => [11, 22],
                    22 => [11, 33]
                ],
                [
                    'dropouts' => [11, 44, 33, 22],
                    'matches' => [],
                ]
            ],
            [
                [
                    11 => ['d', 'c'],
                    22 => ['d', 'c'],
                    33 => ['d', 'c'],
                    44 => ['d', 'c'],
                ],
                [],
                [
                    'dropouts' => [],
                    'matches' => [[11, 22], [33, 44]],
                ]
            ],
            [
                [
                    11 => ['d', 'c'],
                    22 => ['d', 'c'],
                    33 => ['d', 'c'],
                    44 => ['d', 'c'],
                ],
                [
                    11 => [22],
                    22 => [11]
                ],
                [
                    'dropouts' => [],
                    'matches' => [[11, 33], [22, 44]],
                ]
            ],
            [
                [
                    11 => ['d', 'c'],
                    22 => ['d', 'c'],
                    33 => ['d', 'c'],
                    44 => ['d', 'c'],
                ],
                [
                    11 => [22, 33],
                    22 => [11],
                    33 => [11, 44]
                ],
                [
                    'dropouts' => [],
                    'matches' => [[11, 44], [22, 33]],
                ]
            ],
            [
                [
                    11 => ['d', 'c'],
                    22 => ['d', 'c'],
                    33 => ['d', 'c'],
                    44 => ['d', 'c'],
                ],
                [
                    11 => [22, 33, 44],
                    22 => [11],
                    33 => [11, 44],
                    44 => [11, 33]
                ],
                [
                    'dropouts' => [11, 44],
                    'matches' => [[22, 33]],
                ]
            ],
            [
                [
                    11 => ['d', 'c'],
                    22 => ['d', 'c'],
                    33 => ['d', 'c'],
                    44 => ['d', 'c'],
                ],
                [
                    11 => [22, 33, 44],
                    22 => [11, 33],
                    33 => [11, 22, 44],
                    44 => [11, 33]
                ],
                [
                    'dropouts' => [11, 33],
                    'matches' => [[22, 44]],
                ]
            ],
            [
                [
                    11 => ['d', 'c'],
                    22 => ['d', 'c'],
                    33 => ['d', 'c'],
                    44 => ['d', 'c'],
                ],
                [
                    11 => [22, 33, 44],
                    22 => [11, 33, 44],
                    33 => [11, 22, 44],
                    44 => [11, 22, 33]
                ],
                [
                    'dropouts' => [11, 22, 33, 44],
                    'matches' => [],
                ]
            ],
            [
                [
                    11 => ['d'],
                    22 => ['d'],
                    33 => ['d'],
                ],
                [],
                [
                    'dropouts' => [33],
                    'matches' => [[11, 22]],
                ]
            ],
            [
                [
                    11 => ['d'],
                    44 => ['a'],
                    22 => ['d', 'c', 'b'],
                    33 => ['d', 'c'],
                    55 => ['d', 'c'],
                ],
                [],
                [
                    'dropouts' => [44],
                    'matches' => [[11, 33], [55, 22]],
                ]
            ],
            [
                [
                    66 => ['c'],
                    11 => ['d'],
                    44 => ['a'],
                    22 => ['d', 'c', 'b'],
                    33 => ['d', 'c'],
                    55 => ['d', 'c'],
                ],
                [],
                [
                    'dropouts' => [44, 22],
                    'matches' => [[66, 33], [11, 55]],
                ]
            ],
            [
                [
                    11 => ['c'],
                    22 => ['d'],
                    33 => ['d', 'c', 'b'],
                    44 => ['d', 'c'],
                    55 => ['d', 'c'],
                ],
                [],
                [
                    'dropouts' => [33],
                    'matches' => [[11, 44], [22, 55]],
                ]
            ],
            [
                [
                    11 => ['d'],
                    22 => ['a', 'b', 'c', 'd'],
                    33 => ['c'],
                    44 => ['a'],
                    55 => ['d'],
                    66 => ['b', 'c'],
                ],
                [],
                [
                    'dropouts' => [],
                    'matches' => [[11, 55], [33, 66], [44, 22]],
                ]
            ],
            [
                [
                    11 => ['d'],
                    55 => ['b'],
                    33 => ['a'],
                    44 => ['a'],
                    66 => ['b',],
                    22 => ['d'],
                ],
                [],
                [
                    'dropouts' => [],
                    'matches' => [[11, 22], [55, 66], [33, 44]],
                ]
            ],
            [
                [
                    11 => ['a'],
                    22 => ['a', 'b', 'c'],
                    33 => ['b'],
                    44 => ['a', 'b', 'c'],
                    55 => ['c'],
                    66 => ['a', 'b', 'c'],
                ],
                [],
                [
                    'dropouts' => [],
                    'matches' => [[11, 22], [33, 44], [55, 66]],
                ]
            ],
            [
                [
                    2 => ['a', 'b', 'c'],
                    4 => ['a', 'b', 'c'],
                    6 => ['a', 'b', 'c'],
                    1 => ['a'],
                    3 => ['b'],
                    5 => ['c'],
                ],
                [],
                [
                    'dropouts' => [],
                    'matches' => [[1, 2], [5, 4], [3, 6]],
                ]
            ],
            [
                [
                    1 => ['a'],
                    3 => ['b'],
                    5 => ['c'],
                    2 => ['a', 'b', 'c'],
                    4 => ['a', 'b', 'c'],
                    6 => ['a', 'b', 'c'],
                ],
                [],
                [
                    'dropouts' => [],
                    'matches' => [[1, 2], [3, 4], [5, 6]],
                ]
            ],
            [
                [
                    1 => ['a'],
                    2 => ['b'],
                    3 => ['c'],
                    4 => ['d'],
                    5 => ['e'],
                ],
                [],
                [
                    'dropouts' => [1, 2, 3, 4, 5],
                    'matches' => [],
                ]
            ],
            [
                [
                    1 => ['a', 'b', 'c'],
                    2 => ['a', 'b'],
                    3 => ['a', 'f'],
                    4 => ['a', 'c'],
                    5 => ['a'],
                    6 => ['d', 'e', 'f'],
                    7 => ['d', 'e'],
                    8 => ['d', 'f'],
                    9 => ['d'],
                    10 => ['f'],
                    11 => ['a', 'b', 'c', 'd', 'e', 'f'],
                    12 => ['a', 'b', 'c', 'd', 'f'],
                    13 => ['a', 'c', 'd', 'e', 'f'],
                    14 => ['a', 'c', 'f'],
                ],
                [],
                [
                    'dropouts' => [],
                    'matches' => [[5, 2], [10, 3], [9, 7], [4, 1], [8, 6], [14, 12], [13, 11]],
                ]
            ],
            [
                [
                    1 => ['a', 'b', 'c'],
                    2 => ['a', 'b'],
                    3 => ['a', 'f'],
                    4 => ['a', 'c'],
                    5 => ['a'],
                    6 => ['d', 'e', 'f'],
                    7 => ['d', 'e'],
                    8 => ['d', 'f'],
                    9 => ['d'],
                    10 => ['f'],
                    11 => ['a', 'b', 'c', 'd', 'e', 'f'],
                    12 => ['a', 'b', 'c', 'd', 'f'],
                    13 => ['a', 'c', 'd', 'e', 'f'],
                    14 => ['a', 'c', 'f'],
                    15 => ['e'],
                    16 => ['a', 'e', 'f'],
                    17 => ['a', 'e'],
                    18 => ['c', 'f'],
                ],
                [],
                [
                    'dropouts' => [],
                    'matches' => [[5, 2], [10, 3], [15, 7], [9, 8], [4, 17], [18, 6], [1, 14], [16, 12], [13, 11]],
                ]
            ],
        ];
    }
}